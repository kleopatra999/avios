<html>
<head>
<script>
/* 
  Ox - A noughts and crosses game by Neil Robertson.
  Copyright (C) 1996. Last update: 2nd July.
 */

lines="123 456 789 147 258 369 159 357"; // Possible winning lines 
ucnt=0; 
ccnt=0;

// Called when page is first loaded
function start_game()
{
board=new make_array(9);
if (rand()<2) {
	board[5]="X";  // Starting in the centre is always the best move :) 
	redraw_board();
	ccnt=1;
	}
}


// Called whenever a button is pressed
function make_move(but)
{
if (board[but]!=" ") {
	alert("That position is taken!");  return;
	}
++ucnt;
board[but]="O"; 
redraw_board();
if (ccnt+ucnt==9) {  game_drawn();  return;  }

// Make computers first move if we havnt done so yet
if (!ccnt) {
	corners="1379";
	if (but!=5) board[5]="X";  
	else board[corners.charAt(rand())]="X";
	ccnt=1;
	redraw_board()
	return;
	}

// See if player has won
for(i=0;i<8;++i) {
	a=lines.charAt(0+i*4);
	b=lines.charAt(1+i*4);
	c=lines.charAt(2+i*4);
	if (board[a]=="O" && board[b]=="O" && board[c]=="O") {
		player_wins();  return; 
		}
	}

// Look for my pairs
for(i=0;i<8;++i) {
	a=lines.charAt(0+i*4);
	b=lines.charAt(1+i*4);
	c=lines.charAt(2+i*4);
	if (board[a]=="X" && board[b]=="X" && board[c]==" ") {
		board[c]="X";  computer_wins();  return; 
		}
	if (board[a]==" " && board[b]=="X" && board[c]=="X") {
		board[c]="X";  computer_wins();  return; 
		}
	if (board[a]=="X" && board[b]==" " && board[c]=="X") {
		board[c]="X";  computer_wins();  return; 
		}
	}

// Look for opponent pairs to block
for(i=0;i<8;++i) {
	a=lines.charAt(0+i*4);
	b=lines.charAt(1+i*4);
	c=lines.charAt(2+i*4);
	if (board[a]=="O" && board[b]=="O" && board[c]==" ") {
		board[c]="X";  move_end();  return;
		}
	if (board[a]==" " && board[b]=="O" && board[c]=="O") {
		board[a]="X";  move_end();  return;
		}
	if (board[a]=="O" && board[b]==" " && board[c]=="O") {
		board[b]="X";  move_end();  return;
		}
	}

// Look for a possible pair
for(i=0;i<8;++i) {
	a=lines.charAt(0+i*4);
	b=lines.charAt(1+i*4);
	c=lines.charAt(2+i*4);
	if (board[a]=="X" && board[b]==" " && board[c]==" ") {
		board[c]="X";  move_end();  return;
		}
	if (board[a]==" " && board[b]==" " && board[c]=="X") {
		board[a]="X";  move_end();  return;
		}
	if (board[a]==" " && board[b]=="X" && board[c]==" ") {
		board[a]="X";  move_end();  return;
		}
	}
// Pick any old space
for(i=1;i<10;++i) {
	if (board[i]==" ") {
		board[i]="X";  ccnt++;  break;
		}
	}
redraw_board();
if (ccnt+ucnt==9) game_drawn(); 
}


function move_end()
{
redraw_board();  
++ccnt;  
if (ccnt+ucnt==9) game_drawn(); 
}


function computer_wins()
{
redraw_board();
alert("I WIN!! Heh heh. :)");
pause();
reset_game();
}


function player_wins()
{
alert("You win, which isn't possible, must be a bug. :(");
pause();
reset_game();
}


function game_drawn()
{
redraw_board();
alert("GAME DRAWN.");
pause();
reset_game();
}


function reset_game()
{
bf=document.boardform;
ucnt=0;
ccnt=0;
bf.p1.value=" ";
bf.p2.value=" ";
bf.p3.value=" ";
bf.p4.value=" ";
bf.p5.value=" ";
bf.p6.value=" ";
bf.p7.value=" ";
bf.p8.value=" ";
bf.p9.value=" ";
start_game();
}


function redraw_board()
{
bf=document.boardform;
bf.p1.value=board[1];
bf.p2.value=board[2];
bf.p3.value=board[3];
bf.p4.value=board[4];
bf.p5.value=board[5];
bf.p6.value=board[6];
bf.p7.value=board[7];
bf.p8.value=board[8];
bf.p9.value=board[9];
}


function make_array(n)
{
for(i=1;i<10;++i) this[i]=" ";
}


function rand()
{
d=new Date;
return d.getTime()%4;
}


function pause()
{
for(i=0;i<10000;++i);
}


</script>
</head>
<body onLoad="start_game()">

<strong><font color=blue>
*** OX - A NOUGHTS and CROSSES game ***
</font></strong><br><br>
<font color=green>
I am 'X' , you are '0'.<br><br>
</font>

<form name="boardform">

<input type=text name=p1 size=1>
<input type=text name=p2 size=1>
<input type=text name=p3 size=1><br>
<input type=text name=p4 size=1>
<input type=text name=p5 size=1>
<input type=text name=p6 size=1><br>
<input type=text name=p7 size=1>
<input type=text name=p8 size=1>
<input type=text name=p9 size=1><br><br>

<font color=blue>
<input type=button value=" 1 " onClick="make_move(1)">
<input type=button value=" 2 " onClick="make_move(2)">
<input type=button value=" 3 " onClick="make_move(3)"><br>
<input type=button value=" 4 " onClick="make_move(4)">
<input type=button value=" 5 " onClick="make_move(5)">
<input type=button value=" 6 " onClick="make_move(6)"><br>
<input type=button value=" 7 " onClick="make_move(7)">
<input type=button value=" 8 " onClick="make_move(8)">
<input type=button value=" 9 " onClick="make_move(9)"><br><br>

<input type=button value="RESET GAME" onClick="reset_game()">
</font>

</form>
</body>
</html>
